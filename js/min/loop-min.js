!function($,t,o,e,a){"use strict";function n(t){var o=o>0?o-1:0,a=-1===t?f:window.location.protocol+"//"+e.pathInfo.host+e.pathInfo.path.replace(/%d/,t+o)+e.pathInfo.parameters;window.location.href!==a&&history.pushState(null,null,a)}function i(){var t=$(window).scrollTop(),o=t+$(window).height(),e=$(window).height(),a=[],i=!1;if(s.find(".post-set").each(function(){var e=$(this),n=e.offset().top,i=e.outerHeight(!1),p=n+i,r=parseInt(e.attr("data-page-num"));0===i&&$("> *",this).each(function(){i+=e.outerHeight(!1)}),n<t&&p>o?a.push({id:e.attr("id"),top:n,bottom:p,pageNum:r}):n>t&&n<o?a.push({id:e.attr("id"),top:n,bottom:p,pageNum:r}):p>t&&p<o&&a.push({id:e.attr("id"),top:n,bottom:p,pageNum:r})}),0===a.length)i=-1;else if(1===a.length){var p=a.pop();i=(o-p.top)/e<.5?-1:p.pageNum}else{var r=0;$.each(a,function(a,n){var p=0,l=0,s=0;n.top>t&&n.top<o&&(p=(o-n.top)/e),n.bottom>t&&n.bottom<o&&(l=(n.bottom-t)/e),p>=l?s=p:l>=p&&(s=l),s>r&&(i=n.pageNum,r=s)})}"number"==typeof i&&n(i)}function p(){$(window).on("scroll",function(){clearTimeout(m),m=setTimeout(i,100)})}function r(){$(".site-main > div").append('<span class="load-more"></span>');var t=$(".load-more"),o=!1,a={allow:!0,reallow:function(){a.allow=!0},delay:400};$(window).scroll(function(){if(!o&&a.allow){a.allow=!1,setTimeout(a.reallow,a.delay);if(2e3>$(t).offset().top-$(window).scrollTop()){o=!0;var n=$('<div data-page-num="'+g.state.currentPage+'" class="post-set"></div>');g.each(function(t){n.append(d({post:t.attributes,settings:e}))}),s.append(n)}}})}var l=window.document,s=$(".infinite"),u=$("#date-template")[0],c=$("#content-template")[0];if(!s||!c)return!1;var d=o.template(c.innerHTML),f=window.location.href,h=1,w=1,m,g=new wp.api.collections.Posts,v={data:{page:e.page||2,_embed:""}};"archive"===e.loopType?(v.data.filter={},v.data.filter[e.taxonomy.query_var]=e.queriedObject.slug):"search"===e.loopType?v.data.filter={s:e.searchQuery}:"author"===e.loopType&&(v.data.filter={author:e.queriedObject.data.ID}),g.fetch(v).done(function(){g.length>0&&(r(),p())})}(jQuery,Backbone,_,settings);