!function($,t,o,e,a){"use strict";function n(t){var o=o>0?o-1:0,a=-1===t?d:window.location.protocol+"//"+e.pathInfo.host+e.pathInfo.path.replace(/%d/,t+o)+e.pathInfo.parameters;window.location.href!==a&&history.pushState(null,null,a)}function i(){var t=$(window).scrollTop(),o=t+$(window).height(),e=$(window).height(),a=[],i=!1;if(s.find(".post-set").each(function(){var e=$(this),n=e.offset().top,i=e.outerHeight(!1),l=n+i,p=parseInt(e.attr("data-page-num"));0===i&&$("> *",this).each(function(){i+=e.outerHeight(!1)}),n<t&&l>o?a.push({id:e.attr("id"),top:n,bottom:l,pageNum:p}):n>t&&n<o?a.push({id:e.attr("id"),top:n,bottom:l,pageNum:p}):l>t&&l<o&&a.push({id:e.attr("id"),top:n,bottom:l,pageNum:p})}),0===a.length)i=-1;else if(1===a.length){var l=a.pop();i=(o-l.top)/e<.5?-1:l.pageNum}else{var p=0;$.each(a,function(a,n){var l=0,r=0,s=0;n.top>t&&n.top<o&&(l=(o-n.top)/e),n.bottom>t&&n.bottom<o&&(r=(n.bottom-t)/e),l>=r?s=l:r>=l&&(s=r),s>p&&(i=n.pageNum,p=s)})}"number"==typeof i&&n(i)}function l(){$(window).on("scroll",function(){clearTimeout(w),w=setTimeout(i,100)})}function p(){$(".site-main > div").append('<span class="load-more"></span>');var t=$(".load-more"),o=!1,a={allow:!0,reallow:function(){a.allow=!0},delay:400};$(window).scroll(function(){if(!o&&a.allow){a.allow=!1,setTimeout(a.reallow,a.delay);if(2e3>$(t).offset().top-$(window).scrollTop()){o=!0,console.log(m),console.log(g);var n=$('<div data-page-num="'+m.state.currentPage+'" class="post-set"></div>');m.each(function(t){n.append(c({post:t.attributes,settings:e}))}),s.append(n)}}})}var r=window.document,s=$(".infinite"),u=$("#content-template")[0];if(!s||!u)return!1;var c=o.template(u.innerHTML),d=window.location.href,f=1,h=1,w,m=new wp.api.collections.Posts,g={data:{page:e.page||2,_embed:""}};"archive"===e.loopType?(g.data.filter={},g.data.filter[e.taxonomy.query_var]=e.queriedObject.slug):"search"===e.loopType?g.data.filter={s:e.searchQuery}:"author"===e.loopType&&(g.data.filter={author:e.queriedObject.data.ID}),m.fetch(g).done(function(){m.length>0&&(p(),l())})}(jQuery,Backbone,_,settings);